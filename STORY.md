# This is a story

对，这里不仅有代码还有故事。

## 工程名

取工程名之前我考虑了很多。在大四上学期的时候萌生的一个想法，想要弄这么一个可以聊天的机器人。其实我想用的名字是`RASPI_chat` ，很显然就是取自`raspberry pi`和`chat`，但是在打字的时候确实没有注意，就写成`RSP_chat`了。 

很无奈的，一开始我并未发现，但是后来_Tony_问我：你这工程名啥意思啊？我脱口而出：树莓派聊天啊！仔细一看，立刻啪啪啪打脸，这也太抽象了，好吧，我承认我的工程名是很失败的，但是由于很多设置都是这么个名字就一直没改过来。

## 调试

### 平台

刚开始的所有工程都是在`windows 10`上用`Pycharm` 调试的。不得不说，`Pycharm`的安装工具真的`hin`强大。而且如果`windows`中同时安装了`Python 2.7 `和`Python 3.6 `版本，可以在项目中切换，很是方便。对应的`Python`版本可以安装对应的`Packages`，支持一键升级。

后来进行分部调试的时候进入树莓派调试，一直到最后工程完成。

### PyAudio 

在`windows` 上可以无障碍的使用笔记本自带的麦克和音箱，更重要的是支持`PyAudio Package`，这个模块不得了，看过[指导手册](https://people.csail.mit.edu/hubert/pyaudio/docs/) 之后就能会用，这个包的使用还需要一些其他的包，都能在指导手册中找到安装指导。当你在`windows`上用它用的爱不释手，得心应手的时候，你却发现它在`raspberry pi`的`RaspDebian`上，不弄兼容。如果你很有想法，爱折腾，那你就去突破吧，配置好了记得告诉我，反正我是放弃了。改用了系统的录音方式:

```python
os.system('arecord -D "plughw:1,0" -f S16_LE -d 4 -r 16000 {}'.format(self.filename))
```

只是每录取五秒的音频，就进行处理，使得原本反应`hin`快的小橘子，一下子变成了老年痴呆。

### Wave

音频文件处理参照[wave使用手册](https://docs.python.org/3/library/wave.html#module-wave)，根据提取数来的数据可以使用可视化操作，将其转化成横纵坐标的点，在坐标系中展示出来，便能形象生动的展示出来。根据平均值，最小值，最大值等特点，可以把音频文件进行处理，比如去除周围环境噪音，取多少个点进行采样等等。

### API接入

API的接入还是相对容易的。相对与什么呢，当然是开发环境配置啊，有好几个模块在`RaspDebian`上用`pip3`安装的时候，真的差点吐血。参照官方给的手册，多试试，就能把百度语音识别，合成，以及`Turing Robot`的接入弄明白。

这里，在整理的时候发现，百度语音的技术文档竟然有了最近的更新，加入了人脸识别，自然语言处理（NLP），OCR图像识别等功能，而且对应的还有`Java，php，python，C#` 的`SDK`接入，只需要安装就能使用。我去，这太方便了。写完这个，我还要去看看有什么好玩的。

每个平台的后台都能看到，API调用的每日数据，都有免费的上限，平日开发，足够了。对于`Turing Robot`，已经是很智能的中文机器人大脑了，免费提供的知识库内容很是丰富。而且支持自定义导入，并且对敏感词汇有自动过滤。`Turing Robot`的后台数据分析也很到位。

## 收官

忙活了两个多星期，最终还是达到了初步预期的效果。成功完成了毕业设计，但是，在写论文的那几天，我手贱，还想再优化优化，而且想把树莓派连上3.5寸的触摸屏，从_小核桃_那里借来了触摸屏，弄了一下午，结果，系统崩溃了，连上显示器都进不去图形化界面了，一下子从天堂到了地狱。我都做好最坏的打算了，说要是实在弄不好，就带着笔记本去展示代码，带个系统崩溃的树莓派去，啊哈哈哈哈。可是，机智的我还是让系统好用了，主要还是显示的配置问题。

_Tony_说：真想看你在校优答辩现场出现故障。我鄙视的看了他一眼，你可能见不到我，我不想参加校优答辩了。

结果是_Tony_的确没有见到我，因为_小核桃_也不爱去弄那玩意儿，然后我的作品就直接推了校优，免答辩。啊哈哈哈哈。

总之，**小橘子** 就这么收官了。

## At last

Story is yours, and show me the code.